<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <title>SimulacreS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/svg+xml"
          href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAABpzAAAacwGx3qbYAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAABGBJREFUWIW9l11MW2UYgF8c21BGobbQfj3nFE9/DlTKj8tK4jYycC4ZxLhkBgI4I3SLMUK8YiSbwBajxLlkMuFiZheOzuCNYUHYJsToDRvBEcNPLIEIpkkhmBRsC11bSr/XC9Ot0EMtXdlz+53vfd7znvf7OQDxkaQn5HpmerqPk0o/jDNG3EhyVarfmxob6draGp6tqQnqlMpfAeDF5yE/qCXEcbe/H8PpvnmTalWqRQDQ7ppZm5n58aG8PN/8/DyKYbVasUgQfJxMVpdod4peoRg0V1dv+P1+UXkIt9uN75SXb+iVyh8AYF8i5IKOkKWe7u6o4q3c6OykGoXCDgCvxG1mpdJ3jTzvmZqa2pE8xNijR2jkeY8sLe3UTt3JOYTcrqyoCKyursYlD+F0OvHU8ePrmqysbwFgTyxyTqtU2rquXaPPZA6DUoqFgkCNDDMc1Zy+f/+JHLXaPfLgQaLc6HA48KAg0I/q69HI8x4AeElUrsnK6jpx5Mi6w+FImHxoaAh1KhUNNXB7WxuVp6WdE/PvVcvlwc9bW2kwGEyIvKW5GfN4noY3sN1ux1c5bk60AkaWHXlNEGipyUTtdnvcYr/fj+UlJbSirIw6nc6I8TKTyQcAarEcjp6tqgp83dGBAsPQvjt3diyfmZnBXI6j7a2tlFLxHv7OYkE9IddFqyAwjMPlcuHc3BwWajTUXFNDPR5PTHLLrVsosCz9eWgo6nNerxd1DLMCAEkRCajl8ks3OjsR8b+lc+7MGZqv1dLJycmoQeuqq+nhoiK6sLAQU7L1lZUBAHhdrAgZJoPhcfjDAwMDqCWEfnXlSkRNl5eX0ZSbS821tfh/Z0Q4w8PDaOS4oe2a8eHY2NimCW63G98sLqZvlZXR5eVlRHy6xL63WGIWh2Pk+TXYZk84aq6qCohNutTSggLH0braWjRqNNRqtcYlR0T89OJFmpGa+v62zeh2u0UnTkxMIK9Q4NLSUtxyRESbzYYGlv0TAOCFrQn4/P6unu5u0eQKCgogPz8fB+/dEx2PFbVaDTK5nAUAIjYe0YzhjI+P4+HCwmc6rDquXqWCSvUXABwQzdDIsg9HR0e3DVDA83R2dnbHYq/Xi++dPr2hycz8EQD2RqtSjp5h/tl6+QzxyYUL2NzYuCO5zWbDQwaDl5VKG2P9VBKBkN+aGhqCGxsbEW+iZ1kaCIgumAju9vejwLJOAMiPVR4iKYeQz46ZTOuLi4ubgr5RXIz9fX1RxZRSbG9rowIhfwCAdKfyJ6QkJx/TEuIK3+sHBwfxZEnJts3ocrnw7afXsYjVFg+ZOqXS2nr+/JN7g4Hj6NbKICJOT09jgU73WCGRVCdCHM6eXEK+qSgtDaysrOAHZjN+cfnypir0WCyoV6n+ht38S3pZIjlpyM5e/en+fczjeUopxUAggE0NDcFchhkBgNRdk4eh1iqVNj0h2Nvbi2XFxf5sufzL5yEOZ59aJvtFkZHhO5CSUhpPgH8B0KiPtBPftWIAAAAASUVORK5CYII=">

    <style>{{ include_static("../node_modules/bootstrap/dist/css/bootstrap.min.css") }}</style>
    <style>{{ include_static("../node_modules/mdbootstrap/css/mdb.min.css") }}</style>
    <style>{{ include_static("../node_modules/bootstrap-slider/dist/css/bootstrap-slider.min.css") }}</style>
    <style>{{ include_static("../node_modules/bootstrap-select/dist/css/bootstrap-select.min.css") }}</style>
    <style>{{ include_static("../node_modules/@fortawesome/fontawesome-free/css/all.min.css") }}</style>
    <style>{{ include_static("../node_modules/summernote/dist/summernote-bs4.min.css") }}</style>

    <!-- Custom styles -->
    <style>
        /* Set the font (must be here because of the relative path to the font */
        body {
            font-family: Augusta, "Linux Libertine", serif;
        }

        @font-face {
            font-family: Augusta;
            src: url("data:application/truetype;charset=utf-8;base64,{{ augusta_font }}") format("truetype");
            font-weight: normal;
            font-style: normal;
        }

        @font-face {
            font-family: "Linux Libertine";
            src: url("data:application/truetype;charset=utf-8;base64,{{ linux_libertine_font }}") format("truetype");
            font-weight: normal;
            font-style: normal;
        }
    </style>
    <style>{{ include_static("../css/base.css") }}</style>
    <style>{{ include_static("../css/collapsible-table.css") }}</style>
    <style>{{ include_static("../css/status.css") }}</style>
    {% if localisation %}
        <style>{{ include_static("../css/localized_hp.css") }}</style>
    {% endif %}
    <style>{{ include_static("../css/talent.css") }}</style>
    <style>{{ include_static("../css/spells.css") }}</style>
    <style>{{ include_static("../css/rolls.css") }}</style>
    <style>{{ include_static("../css/ki.css") }}</style>
    <style>{{ include_static("../css/background.css") }}</style>
    <style>{{ include_static("../css/notes.css") }}</style>
    <style>{{ include_static("../css/superpowers.css") }}</style>

    <script>{{ include_static("../node_modules/jquery/dist/jquery.min.js") }}</script>
    <script>{{ include_static("../node_modules/popper.js/dist/umd/popper.min.js") }}</script>
    <script>{{ include_static("../node_modules/popper.js/dist/umd/popper-utils.min.js") }}</script>
    <script>{{ include_static("../node_modules/bootstrap/dist/js/bootstrap.min.js") }}</script>
    <script>{{ include_static("../node_modules/mdbootstrap/js/mdb.min.js") }}</script>
    <script>{{ include_static("../node_modules/bootstrap-slider/dist/bootstrap-slider.min.js") }}</script>
    <script>{{ include_static("../node_modules/bootstrap-select/dist/js/bootstrap-select.min.js") }}</script>
    <script>{{ include_static("../node_modules/file-saver/dist/FileSaver.min.js") }}</script>
    <script>{{ include_static("../node_modules/sortablejs/Sortable.min.js") }}</script>
    <script>{{ include_static("../node_modules/jquery-sortablejs/jquery-sortable.js") }}</script>
    <script>{{ include_static("../node_modules/@fortawesome/fontawesome-free/js/all.min.js") }}</script>
    <script>{{ include_static("../node_modules/summernote/dist/summernote-bs4.min.js") }}</script>
    <script>{{ include_static("../node_modules/summernote/dist/lang/summernote-fr-FR.min.js") }}</script>
    <script>{{ include_static("../node_modules/darkreader/darkreader.js") }}</script>
    <script>{{ include_static("../node_modules/json5/dist/index.js") }}</script>
</head>

<body>

<div id="saved-data" class="d-none">
    {}
</div>

<div id="main-container" class="container-fluid main-container px-md-4 px-0 rounded-bottom">

    <!-- Logo -->
    <div id="sheet-header" class="row align-middle justify-content-between d-none d-md-flex">
        <div class="col-md-1 col-2 justify-content-center align-middle">
            {% if version == V7 %}
                <a class="btn btn-light-blue rounded-lg col-12 px-0 mx-0" target="_blank" data-toggle="tooltip"
                   data-html="true" data-placement="bottom" title="Télécharger le mode d'emploi"
                   href="https://github.com/jadinm/simulacres-dynamic-sheet/releases/download/{{ base_tag_version }}/manuel_feuille_perso_simv7.pdf">
                    <i class="fa-solid fa-book"></i>
                </a>
            {% endif %}
        </div>
        <h1 class="mt-1 col-lg-2 col-md-4 col-8 text-center d-flex justify-content-center">
            <svg height="1.5em" width="5em" class="input-prefix" data-toggle="tooltip" data-html="true"
                 data-placement="bottom"
                 title="Simulacres©™ - le jeu de rôle élémentaire a été créé par Pierre Rosenthal. Les règles de Simulacres © sont soumises à copyright et Simulacres™ est une marque déposée.">
                <use href="#svg-simulacres"></use>
            </svg>
            <a id="download-latest-version" target="_blank" data-toggle="tooltip" data-html="true"
               data-placement="right" title="Téléchargez la nouvelle version de la fiche" class="btn-link d-none">
                <i class="fa-solid fa-angles-up fa-sm pl-1 pt-0 pb-3"></i>
            </a>
        </h1>
        <div class="col-md-1 col-2 justify-content-center align-middle">
            <div id="dark-mode" class="btn btn-dark rounded-lg col-12 px-0 mx-0" data-toggle="tooltip" data-html="true"
                 data-placement="bottom" title="Mode sombre">
                <i class="fa-solid fa-moon"></i>
            </div>
            <div id="light-mode" class="btn btn-light rounded-lg col-12 d-none px-0 mx-0" data-toggle="tooltip"
                 data-html="true" data-placement="bottom" title="Mode clair">
                <i class="fa-solid fa-sun"></i>
            </div>
        </div>
    </div>

    {% block body %}
    {% endblock %}

    <div class="form-row row col-12 mt-md-3 mt-0 m-0 p-0">
        <button id="save-page" type="submit" class="btn btn-primary rounded col-md-12 col-10 px-0 py-2 mx-0">
            Sauvegarder
        </button>
        <div class="d-md-none col-2 justify-content-center align-middle">
            <div id="dark-mode-2" class="btn btn-dark rounded-lg col-12 px-0 mx-0" data-toggle="tooltip"
                 data-html="true"
                 data-placement="bottom" title="Mode sombre">
                <i class="fa-solid fa-moon"></i>
            </div>
            <div id="light-mode-2" class="btn btn-light rounded-lg col-12 d-none px-0 mx-0" data-toggle="tooltip"
                 data-html="true" data-placement="bottom" title="Mode clair">
                <i class="fa-solid fa-sun"></i>
            </div>
        </div>
    </div>
    <div class="form-row row col-12 mx-0 mt-0 pb-3 p-0 d-none d-sm-flex">
        <div class="input-group col-sm-6 mx-0 px-0">
            <div class="custom-file">
                <input type="file" class="custom-file-input" id="import-page" accept="text/html">
                <label class="custom-file-label" for="import-page">Importer une ancienne fiche</label>
            </div>
        </div>
        <div class="input-group col-sm-6 mx-0 px-0">
            <div class="custom-file">
                <input type="file" class="custom-file-input" id="import-plugin" accept="text/html"
                       aria-describedby="import-plugin-desc">
                <label class="custom-file-label" for="import-plugin">Importer un plugin</label>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="d-flex row col-12 mb-1 m-0 p-0 rounded">
        <div class="ml-auto">
            <small>
                Projet créé par Mathieu Jadin et disponible sous GPL-3.0 License sur
                <a href="https://github.com/jadinm/simulacres-dynamic-sheet">Github</a>
                <button class="btn btn-outline-info m-0 p-0 rounded-circle" data-toggle="modal"
                        data-target="#about-sheet" style="min-width: 1.7em">
                    <i class="fa-solid fa-info fa-sm"></i>
                </button>
            </small>
        </div>
    </footer>
</div>

<!-- Modals -->

{% include "modal/tab_list_modal.html" %}

{% include "modal/about_sheet_modal.html" %}

{% include "modal/debug_modal.html" %}

{% include "modal/ap_cost_modal.html" %}

<!-- Status -->
{% with base_id = "" %}
    {% include "modal/status_dialogs.html" %}
{% endwith %}

<!-- Rolls -->
{% include "modal/roll_dialog.html" %}

<!-- Equipment -->
{% include "modal/equipment_dialogs.html" %}

<!-- SVG images -->
{% include "images.html" %}

<!-- Allow bootstrap screen size detection from js -->
<div id="sizer">
    <div class="d-block d-sm-none d-md-none d-lg-none d-xl-none" data-size="xs"></div>
    <div class="d-none d-sm-block d-md-none d-lg-none d-xl-none" data-size="sm"></div>
    <div class="d-none d-sm-none d-md-block d-lg-none d-xl-none" data-size="md"></div>
    <div class="d-none d-sm-none d-md-none d-lg-block d-xl-none" data-size="lg"></div>
    <div class="d-none d-sm-none d-md-none d-lg-none d-xl-block" data-size="xl"></div>
</div>

</body>

<!-- Audio resources -->
{% for audio in audios %}
    <audio preload="auto" class="audio-roll">
        <source src="data:audio/wav;base64,{{ audio }}" type="audio/x-wav">
    </audio>
{% endfor %}

<!-- Custom Javascript -->
<script>
    let debug = false
    {% if debug %}
        debug = true
    {% endif %}
    let npc_grid = false
    {% if npc_grid %}
        npc_grid = true
    {% endif %}
    const base_sheet_name = "{{ base_sheet_name }}"
    const base_tag_version = "{{ base_tag_version }}"
    let is_v7 = true
    let localized_hp = false
    let localized_target_hp = false
    let matrix_4x4 = false
    {% if localisation %}
        localized_hp = true
    {% endif %}
    {% if localisation_target %}
        localized_target_hp = true
    {% endif %}
    {% if version != V7 %}
        is_v7 = false
        matrix_4x4 = false
    {% endif %}
    {% if matrix_4x4 %}
        matrix_4x4 = true
    {% endif %}
    let intermediate_discovery = false
    {% if intermediate_discovery %}
        intermediate_discovery = true
    {% endif %}
    let discovery = false
    {% if discovery %}
        discovery = true
    {% endif %}
    let universe = null
    {% if universe %}
        universe = "{{ universe }}"
    {% endif %}
    let captain_voodoo = "{{ captain_voodoo }}"
    let med_fantasy = "{{ med_fantasy }}"
</script>
<script>{{ include_static("../js/logger.js") }}</script>
<script>{{ include_static("../js/utils.js") }}</script>
<script>{{ include_static("../js/graph.js") }}</script>
<script>{{ include_static("../js/model.js") }}</script>
<script>{{ include_static("../js/resize.js") }}</script>
<script>{{ include_static("../js/import_export.js") }}</script>
<script>{{ include_static("../js/adventure_points.js") }}</script>
{% if version == V7 %}
    <script>{{ include_static("../js/adventure_points_v7.js") }}</script>
{% else %}
    <script>{{ include_static("../js/adventure_points_v8.js") }}</script>
{% endif %}
<script>{{ include_static("../js/characteristics.js") }}</script>
<script>{{ include_static("../js/checkboxes.js") }}</script>
<script>{{ include_static("../js/slider.js") }}</script>
<script>{{ include_static("../js/select.js") }}</script>
<script>{{ include_static("../js/status.js") }}</script>
<script>{{ include_static("../js/data_tables.js") }}</script>
<script>{{ include_static("../js/equipment.js") }}</script>
{% if universe == med_fantasy %}
    <script id="default-talents">{{ include_static("../js/talent_med_fantasy.js") }}</script>
{% elif universe == captain_voodoo %}
    <script id="default-talents">{{ include_static("../js/talent_captain_voodoo.js") }}</script>
{% else %}
    <script id="default-talents">default_talents = {x: [], "-4": [], "-2": [], "0": []}</script>
{% endif %}
<script>{{ include_static("../js/talent.js") }}</script>
<script>{{ include_static("../js/roll_dialog.js") }}</script>
<script>{{ include_static("../js/roll_tab.js") }}</script>
<script>{{ include_static("../js/magic.js") }}</script>
<script>{{ include_static("../js/psi.js") }}</script>
<script>{{ include_static("../js/warrior.js") }}</script>
<script>{{ include_static("../js/ki.js") }}</script>
<script>{{ include_static("../js/superpowers.js") }}</script>
<script id="script-summernote">{{ include_static("../js/summernote.js") }}</script>
<script>{{ include_static("../js/background.js") }}</script>
<script>{{ include_static("../js/notes.js") }}</script>
<script id="script-note-dialog">{{ include_static("../js/notes_dialog.js") }}</script>
<script>{{ include_static("../js/merchant.js") }}</script>
<script>{{ include_static("../js/npc_grid.js") }}</script>
<script>{{ include_static("../js/character.js") }}</script>
<script>{{ include_static("../js/plugin.js") }}</script>

{% for css_block in plugins.css_blocks %}
    {{ css_block | safe }}
{% endfor %}
{% for js_block in plugins.js_blocks %}
    {{ js_block | safe }}
{% endfor %}

<script>
    $(_ => {
        changed_page = false // Because this was not changed by the user
    })
</script>

<!-- JS modules cannot be directly included in the HTML -->
<script id="script-emoji" type="module" src="https://cdn.jsdelivr.net/npm/emoji-picker-element@^1/index.js"></script>
</html>
